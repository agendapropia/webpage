let div=$("#tableMain"),route="/admin/specials/list",structure=[" ","Estado","Nombre","Url","Fecha publicación","# vistos"];var TableMain=new tableGear(div,route,structure);TableMain.refresh(!0);let modalCreateMain=$("#modal-create-main"),formCreateMain=$("form[name=form-create-main]");function ActionMainCreate(){UtilFormClose(formCreateMain),queryCreateMain.Send(),countrySelectCreate.clearSelect(),tagsSelectCreate.clearSelect(),alliedMediasSelectCreate.clearSelect(),modalCreateMain.find("input[name=publication_date]").flatpickr(settingDate)}let countrySelectCreate=new searchByAutocomplete(formCreateMain.find(".countrySelect"),{params:[],url:"/admin/configurations/countries/search-by-autocomplete",limitItems:10,minimumCharactersToSearch:1}),tagsSelectCreate=new searchByAutocomplete(formCreateMain.find(".tagsSelect"),{params:[],url:"/admin/configurations/tags/search-by-autocomplete",limitItems:10,minimumCharactersToSearch:1}),alliedMediasSelectCreate=new searchByAutocomplete(formCreateMain.find(".alliedMediaSelect"),{params:[],url:"/admin/specials/allied-media/search-by-autocomplete",limitItems:10,minimumCharactersToSearch:1}),queryCreateMain=new QueryAjax({url:"/admin/specials/create",method:"GET",action:"CreateActionModal",listTable:TableMain});function CreateActionModal(e,a){e&&LoadSelectUtil(modalCreateMain.find("select[name=template_id]"),a.data.templates,1)}let ActionSendMain=new QueryAjax({form:"form-create-main",action:"FinishActionCreateMain",listTable:TableMain});function FinishActionCreateMain(e){e&&(notify(!1,"Region creado","Operación realizada exitosamente",2),ActionSendMain.FormClose(),TableMain.refresh())}let modalUpdateMain=$("#modal-update-main"),formUpdateMain=$("form[name=form-update-main]");function ActionMainUpdate(e){UtilClearFormUi(formUpdateMain),queryInitialUpdateMain.var.id=e.id,formUpdateMain.find("input[name=id]").val(e.id),queryInitialUpdateMain.Send(),countrySelectUpdate.clearSelect(),tagsSelectUpdate.clearSelect(),alliedMediasSelectUpdate.clearSelect(),modalUpdateMain.find("input[name=publication_date]").flatpickr(settingDate)}let countrySelectUpdate=new searchByAutocomplete(formUpdateMain.find(".countrySelect"),{params:[],url:"/admin/configurations/countries/search-by-autocomplete",limitItems:10,minimumCharactersToSearch:1}),tagsSelectUpdate=new searchByAutocomplete(formUpdateMain.find(".tagsSelect"),{params:[],url:"/admin/configurations/tags/search-by-autocomplete",limitItems:10,minimumCharactersToSearch:1}),alliedMediasSelectUpdate=new searchByAutocomplete(formUpdateMain.find(".alliedMediaSelect"),{params:[],url:"/admin/specials/allied-media/search-by-autocomplete",limitItems:10,minimumCharactersToSearch:1}),queryInitialUpdateMain=new QueryAjax({url:"/admin/specials/update",method:"GET",action:"UpdateActionModal",listTable:TableMain});function UpdateActionModal(e,a){e&&(utilLoadAutoCompleteByArray(a.data.countries,countrySelectUpdate),utilLoadAutoCompleteByArray(a.data.tags,tagsSelectUpdate),utilLoadAutoCompleteByArray(a.data.alliedMedia,alliedMediasSelectUpdate),LoadSelectUtil(modalUpdateMain.find("select[name=template_id]"),a.data.templates,a.data.special.template_id),LoadFormInputs(modalUpdateMain,a.data.special))}let ActionMainUpdateSend=new QueryAjax({form:"form-update-main",action:"FunctionActionUpdateMain",listTable:TableMain});function FunctionActionUpdateMain(e,a){e&&(notify(!1,"Especial Actualizado","Operación realizada exitosamente",2),ActionMainUpdateSend.FormClose(),TableMain.refresh())}let modalSpecialUsers=$("#modal-special-users"),formCreateSpecialUsers=modalSpecialUsers.find("form[name=form-special-users]"),divUser=$("#table-special-users"),routeUser="/admin/specials/users/list",structureUser=[" ","Nombre","Role"];var TableSpecialUsers=new tableGear(divUser,routeUser,structureUser);function ActionModalUsers(e){UtilClearFormUi(formCreateSpecialUsers),modalSpecialUsers.find(".modal-subtitle").text(` (${e.name})`),TableSpecialUsers.filter.id=e.id,formCreateSpecialUsers.find("input[name=special_id]").val(e.id),TableSpecialUsers.refresh(!1),userSelectUpdate.clearSelect(),QueryModalDataUsers.Send()}TableSpecialUsers.modalSelect=modalSpecialUsers,TableSpecialUsers.tablePaginate=!1,TableSpecialUsers.filter.row=200;let userSelectUpdate=new searchByAutocomplete(formCreateSpecialUsers.find(".usersSelect"),{params:[],url:"/admin/accounts/users/search-by-autocomplete",limitItems:1,minimumCharactersToSearch:1}),QueryModalDataUsers=new QueryAjax({url:"/admin/specials/roles",method:"GET",action:"ActionModalDataUsers",listTable:TableSpecialUsers});function ActionModalDataUsers(e,a){e&&LoadSelectUtil(formCreateSpecialUsers.find("select[name=special_role_id]"),a.data.roles)}let QueryModalCreateUsers=new QueryAjax({form:"form-special-users",action:"ActionModalCreateUsers",loaderSelected:modalSpecialUsers.find(".overlay-modal")});function ActionModalCreateUsers(e,a){if(!e)return!1;a.status?(notify(!1,"Usuario asociado","Operación realizada exitosamente",2),QueryModalCreateUsers.FormClose(!1),TableSpecialUsers.refresh(!1)):(notify(!1,"Usuario ya esta asociado","",1),QueryModalCreateUsers.FormClose(!1)),userSelectUpdate.clearSelect()}function ButtonModalDeleteUsers(e){let a=$(e).parent().parent().data("id");QueryModalDeleteUsers.var.id=a,QueryModalDeleteUsers.Send()}let QueryModalDeleteUsers=new QueryAjax({url:"/admin/specials/users",method:"DELETE",action:"ActionModalDeleteUsers",listTable:TableSpecialUsers});function ActionModalDeleteUsers(e){if(!e)return!1;notify(!1,"Usuario eliminado","Operación realizada exitosamente",1),TableSpecialUsers.refresh(!1)}var modalFiles=$("#modal-utils-imagen-selections"),divFiles=$(".div-files-class"),selectImageType=$("select[name=image_type]"),specialFiles=new updloadS3(divFiles,{url:"/admin/specials/files",typeFile:1,id:1,reload:!1,limitFiles:10});function ActionFilesLoad(e){modalFiles.find(".modal-subtitle").text(`(${e.name})`),selectImageType.val(1),specialFiles.clear(),specialFiles.variables.id=e.id,specialFiles.variables.external_id=e.id,specialFiles.variables.source_id=1,specialFiles.loading.show(),ActionQueryFilesList.var.id=e.id,ActionQueryFilesList.var.type=1,ActionQueryFilesList.Send()}selectImageType.change((function(){specialFiles.clear(),specialFiles.variables.source_id=$(this).val(),specialFiles.loading.show(),ActionQueryFilesList.var.type=$(this).val(),ActionQueryFilesList.Send()}));let ActionQueryFilesList=new QueryAjax({url:"/admin/specials/files",method:"GET",action:"FinishActionQueryFilesList"});function FinishActionQueryFilesList(e,a){e&&specialFiles.loadData(a.data,ActionQueryFilesList.var.id)}
